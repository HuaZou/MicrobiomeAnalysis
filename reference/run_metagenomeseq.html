<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>metagenomeSeq differential analysis — run_metagenomeseq • MicrobiomeAnalysis</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="metagenomeSeq differential analysis — run_metagenomeseq"><meta property="og:description" content="Differential expression analysis based on the Zero-inflated Log-Normal
mixture model or Zero-inflated Gaussian mixture model using metagenomeSeq."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MicrobiomeAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Introduction.html">MicrobiomeAnalysis: A comprehensive R package for managing and analyzing microbiome data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/HuaZou/MicrobiomeAnalysis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>metagenomeSeq differential analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/HuaZou/MicrobiomeAnalysis/blob/HEAD/R/da_metagenomeSeq.R" class="external-link"><code>R/da_metagenomeSeq.R</code></a></small>
    <div class="hidden name"><code>run_metagenomeseq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Differential expression analysis based on the Zero-inflated Log-Normal
mixture model or Zero-inflated Gaussian mixture model using metagenomeSeq.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">run_metagenomeseq</span><span class="op">(</span>
  <span class="va">ps</span>,
  <span class="va">group</span>,
  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,
  contrast <span class="op">=</span> <span class="cn">NULL</span>,
  taxa_rank <span class="op">=</span> <span class="st">"all"</span>,
  transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"identity"</span>, <span class="st">"log10"</span>, <span class="st">"log10p"</span>, <span class="st">"SquareRoot"</span>, <span class="st">"CubicRoot"</span>, <span class="st">"logit"</span><span class="op">)</span>,
  norm <span class="op">=</span> <span class="st">"CSS"</span>,
  norm_para <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ZILN"</span>, <span class="st">"ZIG"</span><span class="op">)</span>,
  p_adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"fdr"</span>, <span class="st">"bonferroni"</span>, <span class="st">"holm"</span>, <span class="st">"hochberg"</span>, <span class="st">"hommel"</span>, <span class="st">"BH"</span>, <span class="st">"BY"</span><span class="op">)</span>,
  pvalue_cutoff <span class="op">=</span> <span class="fl">0.05</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ps</dt>
<dd><p>ps a <code><a href="https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html" class="external-link">phyloseq::phyloseq</a></code> object.</p></dd>
<dt>group</dt>
<dd><p>character, the variable to set the group, must be one of
the var of the sample metadata.</p></dd>
<dt>confounders</dt>
<dd><p>character vector, the confounding variables to be adjusted.
default <code>character(0)</code>, indicating no confounding variable.</p></dd>
<dt>contrast</dt>
<dd><p>this parameter only used for two groups comparison while
there are multiple groups. For more please see the following details.</p></dd>
<dt>taxa_rank</dt>
<dd><p>character to specify taxonomic rank to perform
differential analysis on. Should be one of <code>phyloseq::rank_names(ps)</code>,
or "all" means to summarize the taxa by the top taxa ranks
(<code>summarize_taxa(ps, level = rank_names(ps)[1])</code>), or "none" means perform
differential analysis on the original taxa (<code>taxa_names(ps)</code>, e.g.,
OTU or ASV).</p></dd>
<dt>transform</dt>
<dd><p>character, the methods used to transform the microbial
abundance. See <code><a href="transform_abundances.html">transform_abundances()</a></code> for more details. The
options include:</p><ul><li><p>"identity", return the original data without any transformation
(default).</p></li>
<li><p>"log10", the transformation is <code>log10(object)</code>, and if the data contains
zeros the transformation is <code>log10(1 + object)</code>.</p></li>
<li><p>"log10p", the transformation is <code>log10(1 + object)</code>.</p></li>
<li><p>"SquareRoot", the transformation is <code>Square Root</code>.</p></li>
<li><p>"CubicRoot", the transformation is <code>Cubic Root</code>.</p></li>
<li><p>"logit", the transformation is <code>Zero-inflated Logit Transformation</code>
(Does not work well for microbiome data).</p></li>
</ul></dd>
<dt>norm</dt>
<dd><p>the methods used to normalize the microbial abundance data. See
<code><a href="normalize-methods.html">normalize()</a></code> for more details.
Options include:</p><ul><li><p>"none": do not normalize.</p></li>
<li><p>"rarefy": random subsampling counts to the smallest library size in the
data set.</p></li>
<li><p>"TSS": total sum scaling, also referred to as "relative abundance", the
abundances were normalized by dividing the corresponding sample library
size.</p></li>
<li><p>"TMM": trimmed mean of m-values. First, a sample is chosen as reference.
The scaling factor is then derived using a weighted trimmed mean over the
differences of the log-transformed gene-count fold-change between the
sample and the reference.</p></li>
<li><p>"RLE", relative log expression, RLE uses a pseudo-reference calculated
using the geometric mean of the gene-specific abundances over all
samples. The scaling factors are then calculated as the median of the
gene counts ratios between the samples and the reference.</p></li>
<li><p>"CSS": cumulative sum scaling, calculates scaling factors as the
cumulative sum of gene abundances up to a data-derived threshold.</p></li>
<li><p>"CLR": centered log-ratio normalization.</p></li>
<li><p>"CPM": pre-sample normalization of the sum of the values to 1e+06.</p></li>
</ul></dd>
<dt>norm_para</dt>
<dd><p>arguments passed to specific normalization methods.</p></dd>
<dt>method</dt>
<dd><p>character, which model used for differential analysis,
"ZILN" (Zero-inflated Log-Normal mixture model)" or "ZIG" (Zero-inflated
Gaussian mixture model). And the zero-inflated log-normal model is
preferred due to the high sensitivity and low FDR.</p></dd>
<dt>p_adjust</dt>
<dd><p>method for multiple test correction, default <code>none</code>,
for more details see <a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">stats::p.adjust</a>.</p></dd>
<dt>pvalue_cutoff</dt>
<dd><p>numeric, p value cutoff, default 0.05</p></dd>
<dt>...</dt>
<dd><p>extra arguments passed to the model. more details see
<code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitFeatureModel.html" class="external-link">metagenomeSeq::fitFeatureModel()</a></code> and <code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitZig.html" class="external-link">metagenomeSeq::fitZig()</a></code>,
e.g. <code>control</code> (can be setted using <code><a href="https://rdrr.io/pkg/metagenomeSeq/man/zigControl.html" class="external-link">metagenomeSeq::zigControl()</a></code>) for
<code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitZig.html" class="external-link">metagenomeSeq::fitZig()</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a <code><a href="microbiomeMarker-class.html">microbiomeMarker</a></code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>metagnomeSeq provides two differential analysis methods, zero-inflated
log-normal mixture model (implemented in
<code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitFeatureModel.html" class="external-link">metagenomeSeq::fitFeatureModel()</a></code>) and zero-inflated Gaussian mixture
model (implemented in <code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitZig.html" class="external-link">metagenomeSeq::fitZig()</a></code>). We recommend
fitFeatureModel over fitZig due to high sensitivity and low FDR. Both
<code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitFeatureModel.html" class="external-link">metagenomeSeq::fitFeatureModel()</a></code> and <code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitZig.html" class="external-link">metagenomeSeq::fitZig()</a></code> require
the abundance profiles before normalization.</p>
<p>For <code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitZig.html" class="external-link">metagenomeSeq::fitZig()</a></code>, the output column is the coefficient of
interest, and logFC column in the output of
<code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitFeatureModel.html" class="external-link">metagenomeSeq::fitFeatureModel()</a></code> is analogous to coefficient. Thus,
logFC is really just the estimate the coefficient of interest in
<code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitFeatureModel.html" class="external-link">metagenomeSeq::fitFeatureModel()</a></code>. For more details see
these question <a href="https://support.bioconductor.org/p/94138/" class="external-link">Difference between fitFeatureModel and fitZIG in metagenomeSeq</a>.</p>
<p><code>contrast</code> must be a two length character or <code>NULL</code> (default). It is only
required to set manually for two groups comparison when there are multiple
groups. The order determines the direction of comparison, the first element
is used to specify the reference group (control). This means that, the first
element is the denominator for the fold change, and the second element is
used as baseline (numerator for fold change). Otherwise, users do required
to concern this paramerter (set as default <code>NULL</code>), and if there are
two groups, the first level of groups will set as the reference group; if
there are multiple groups, it will perform an ANOVA-like testing to find
markers which difference in any of the groups.</p>
<p>Of note, <code><a href="https://rdrr.io/pkg/metagenomeSeq/man/fitFeatureModel.html" class="external-link">metagenomeSeq::fitFeatureModel()</a></code> is not allows for multiple
groups comparison.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Paulson, Joseph N., et al. "Differential abundance analysis for microbial
marker-gene surveys." Nature methods 10.12 (2013): 1200-1202.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Yang Cao</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">enterotypes_arumugam</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="va">enterotypes_arumugam</span>,</span>
<span class="r-in">    <span class="va">Enterotype</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Enterotype 3"</span>, <span class="st">"Enterotype 2"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="fu">run_metagenomeseq</span><span class="op">(</span><span class="va">ps</span>, group <span class="op">=</span> <span class="st">"Enterotype"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Default value being used.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Partial NA coefficients for 91 probe(s)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: fitted probabilities numerically 0 or 1 occurred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> microbiomeMarker-class inherited from phyloseq-class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normalization method:              [ CSS ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> microbiome marker identity method: [ metagenomeSeq: ZILN ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> marker_table() Marker Table:       [ 16 microbiome markers with 5 variables ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> otu_table()    OTU Table:          [ 235 taxa and  24 samples ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample_data()  Sample Data:        [ 24 samples by  10 sample variables ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_table()    Taxonomy Table:     [ 235 taxa by 1 taxonomic ranks ]</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hua Zou.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

